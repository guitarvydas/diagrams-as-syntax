<!DOCTYPE html>
<html>
<head>
<style>
textarea {
}
</style>
</head>
<body>

<h1>DaS Transpiler Workbench (app.diagrams.net to xvg to ...)</h1>

<p>grok:</p>
<textarea id="grammar" name="a" rows="1" cols="90" placeholder="grammar" style="background-color:oldlace;">
AppDiagramsNet{
TabbedDiagrams = Header Diagram+ Trailer
Header = "<" "mxfile" encodedChar+
Trailer = "</mxfile>"
Diagram = "<diagram" Attribute* ">" encodedChar+ "</diagram>"
Attribute = alnum+ "=" string
string= "\"" notDQ* "\""
notDQ = ~"\"" any
encodedChar = ~"<" any		   
}
</textarea>

<p>emit:</p>
<textarea id="semantics" rows="1" cols="90" placeholder="semantics" style="background-color:oldlace;">
TabbedDiagrams [h @d t] = [[${d}]]
Header [k k2 @ec] = [[${k}${k2}${ec}]]
Trailer [k] = [[${k}]]
Diagram [k @a k2 @ec k3] = [[${k}${a}${k2}\n${decodeMxDiagram(ec)}\n${k3}\n]]
Attribute [@an k s] = [[\ ${an}${k}${s}]]
string [q1 @cs q2] = [[${q1}${cs}${q2}]]
notDQ [c] = [[${c}]]
encodedChar [c] = [[${c}]]
</textarea>

<p>source:</p>
<textarea id="source" name="source" rows="17" cols="90" placeholder="notation test" style="background-color:oldlace;">
<mxfile host="Electron" modified="2021-07-20T03:09:53.162Z" agent="5.0 (Macintosh; Intel Mac OS X 11_3_1) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/14.6.13 Chrome/89.0.4389.128 Electron/12.0.7 Safari/537.36" etag="LbURwSQn83haC3DuYDt_" version="14.6.13" type="device" pages="3">
<diagram id="HQaUK7b0CWS-_TARSPO3" name="hwapp">5VdNj5swEP01HFsFDITrbpJuq3a1h0jtdi+Vgw24MRg5QyD99bXBfJVsmlZJtdWSQ5g34zF+bzwGCy3S6k7iPLkXhHLLmZHKQkvLcWx75qs/jRwaJGiBWDJignpgzX5QA84MWjBCd6NAEIIDy8dgKLKMhjDCsJSiHIdFgo9nzXFMJ8A6xHyKfmEEkm5ds97xnrI4MVMHnnGkuA02wC7BRJQDCK0stJBCQHOXVgvKNXktL824d894uweTNINzBsjiXmyePm9jutp/fHrIkP9h+cZk2WNemAVb6EYBSYnz3Dw3HFoypCgyQnU+20K3ZcKArnMcam+p5FdYAik37j2VwBSRN5zFmcJA6ICIcb4QXMg6I4o8/VP4DqTY0oHHry89QmQwwJtL4dP1t4tRE9NqABk+7qhIKciDCmm9rTZdcTZm2SvtugZLBiJ31YlNdcVd6l4AdWM0+AM9nIkeTNW1VFCjy7dMZDilW5aRa6hzCU6DMacdxwNSkXOEVNu9FqloQqooYEKfSqSaCv09dXiXN50mYpWme1LTUeSEoQ403IaKTaXhkSIn/sb3dJErcuFBzchA06Z6yEW08NxftJh7Uy2OSIGupYQ7ZZ2odmtMISERsSpwvurR276sNSt9zCehS7ZW5DsFOJizAxcgxnrRisHj4P6rTvXWM9ayMplr49AamVru49AYjNJmP6y22nHPirYThQzpCWqMMoBlTOFEnDk+NW8nS0BSjoHtx8fYxQX1jvSr6+0s4tGAuGftrMDZIP96O8u2X9jO8l+rEHP3ZQkx/19a3N+3quDMVoVeVKsKXutbgPvvtogy+w+a2jf4LESrnw==
</diagram>
<diagram id="PCEYNFZqdCUcrfXb7Y2_" name="hwsub">5Vddk5owFP01PG5HiCg+ruja7thPZ6fbvnQiuUB2A3FiVOivbwJhAXGsdup2O4sP5p7cXOCc+zFYyE+ymcCr+D0nwCynRzILTSzHsXtDV/1pJC+RoTMqgUhQYpxqYEF/QnXSoBtKYN1ylJwzSVdtMOBpCoFsYVgIvmu7hZy177rCEXSARYBZF/1KiYwNavd69cZboFFsbu25ZiPBlbMB1jEmfNeA0NRCvuBclqsk84Fp8ipeZtT7PEJz/zbZvgvz4WQx/+5dlcFuzjny9AoCUvnHod0PYH8J724+TVa90XSbP9wS/8orQ28x2xi+LHStgHi33izNa8u84lLwTUpAx7MtNN7FVMJihQO9u1PZo7BYJsxsb0FIqnS4ZjRKFSa5dggpYz5nXBQRUejqn8LXUvBHaOwMikuf4Kls4OWl8BNJMeTpp4GskRKGpBnwBKTIlYvZHZmEN/neN+rv6uRBVUbEjbyxK0dsEjZ6ilyLohZGlzM0GnU0irlSRD1EIdWPVFUOTuCRpuQSil2KZ9vrtYiuGk2DaNs9QPTwUjxXHatBHxDVS4zJhYx5xFPMpjU6rglWcoxrnznX5BW0PoCUuWmMeCN5m3TIqLxvrL/pUG9cY00yE7kwcmOcJ8mab0QAx1686stYRCCPOaLSUdNyVGIBDEu6bbfgvy9YlXN1ZVx3JWRMjRr4ffbj9aqcPyHNtKD7rYq44JG+djTlESj2QRzqXZ6zREXvUqUgP6o7Uqmlc8/X7vRy2qumUbea0IFiQhcrJqejzfhy2oRh6ATBSdqQwXLgPrM2aG+m/HNxUEcc/9UWjj14YeL0/5cxpIQQ+X3TaJzSZn2ssC41vtxTx5fzssaX26nCyettkfZzVaEy62+2Yq/x5YumvwA=
</diagram>
<diagram id="dkHnfYNpTtgTAUIm52f-" name="hwhello">vZbfb5swEMf/Gh47YRwQfVyzLtO0aJMirc8OPrA3g5FxCulfPzuYX3WkLtroE/h75zvdfc6GAG/LbqdIzfaSggiikHYB/hREEUJhYh5WOfdKOgiF4tQ5TcKBv4ATQ6eeOIVm4ailFJrXSzGTVQWZXmhEKdku3XIplllrUoAnHDIifPWJU83GusLJ8AV4wVzqNHaGkgzOTmgYobKdSfgxwFslpe7fym4LwjZv6Au/i3+xl68/DuH+2+5pJ/YY/bzrg32+ZctYgoJK/+fQrrZnIk6uYaxlZqN0Nevz0EglTxUFGwwF+KFlXMOhJpm1tmZ0jMZ0KZxZGgvXdmRMO/EDEbyozCIzBYAywjMozQ2kj86gpQ2QcyG2Ukh1yYjzNIMsM3qjlfwNM8sxjTeXwH/ZGddBmxW62Vy4Tu1AlqDV2biMc3/fbxmnvl+20wjh0Lmw2fSgoaHEjW0xhp7QmBdH5xZSyCf175woadjoeyu0klNqs65H4T78EC84oMgHgZIrIHC8FgfsceCVB8EEMhccvA2ANHV/6+W8syBenwEaQ0o312h4hyKNjjhJjMV0V39fslzvnCCPUDQoi8NyBdFqR2XjIZInvR6jPM+jyz31NiOaHJP4nRltwvg9GZnl9E282GZ/FvjxDw==
</diagram>
</mxfile>
</textarea>

<p>transpiled:</p>
<textarea id="transpiled" name="transpiled" rows="17" cols="90" placeholder="transpiled"  readonly style="background-color:whitesmoke;">
</textarea>
<br>
<br>
<p id="status" > READY </p>

<br>
<button onclick="generate ()">Generate</button>
<script src="../scnwb/ohm.js"></script>
<script src="../scnwb/glue.js"></script>
<script src="../scnwb/scope.js"></script>
<script src="../scnwb/pako/dist/pako_inflate.js"></script>
<script src="support.js"></script>
<script>


  function generate () {
      let scnGrammar = document.getElementById('grammar').value;
      let notationSource = document.getElementById('source').value;
      let semantics = document.getElementById('semantics').value;
      let generatedSCNSemantics = transpiler (semantics, glueGrammar, "_glue", glueSemantics);

      _ruleInit();
      try {
          document.getElementById('status').innerHTML = "FAILED";
          let semObject = eval('(' + generatedSCNSemantics + ')');
          document.getElementById ("transpiled").value = semObject;
          let tr = transpiler(notationSource, scnGrammar, "_glue", semObject);
          document.getElementById('transpiled').value = tr;
          document.getElementById('status').innerHTML = "OK";
      }
       catch (err) {
          document.getElementById('status').innerHTML = err;
       }
  }
  </script>
</body>
</html>

